"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var _regeneratorRuntime=_interopDefault(require("@babel/runtime/regenerator")),_slicedToArray=_interopDefault(require("@babel/runtime/helpers/slicedToArray")),_createClass=_interopDefault(require("@babel/runtime/helpers/createClass")),QuickLRU=function(){function e(e){if(!(e.maxSize&&0<e.maxSize))throw new TypeError("`maxSize` must be a number greater than 0");this.maxSize=e.maxSize,this.cache=new Map,this.oldCache=new Map,this._size=0}var t=e.prototype;return t._set=function(e,t){this.cache.set(e,t),this._size++,this._size>=this.maxSize&&(this._size=0,this.oldCache=this.cache,this.cache=new Map)},t.get=function(e){if(this.cache.has(e))return this.cache.get(e);if(this.oldCache.has(e)){var t=this.oldCache.get(e);return this.oldCache.delete(e),this._set(e,t),t}},t.set=function(e,t){return this.cache.has(e)?this.cache.set(e,t):this._set(e,t),this},t.has=function(e){return this.cache.has(e)||this.oldCache.has(e)},t.peek=function(e){return this.cache.has(e)?this.cache.get(e):this.oldCache.has(e)?this.oldCache.get(e):void 0},t.delete=function(e){var t=this.cache.delete(e);return t&&this._size--,this.oldCache.delete(e)||t},t.clear=function(){this.cache.clear(),this.oldCache.clear(),this._size=0},t.keys=_regeneratorRuntime.mark(function e(){var t,r,a,n,i,s,c;return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=!(t=!0),a=void 0,e.prev=3,n=this[Symbol.iterator]();case 5:if(t=(i=n.next()).done){e.next=12;break}return s=_slicedToArray(i.value,1),c=s[0],e.next=9,c;case 9:t=!0,e.next=5;break;case 12:e.next=18;break;case 14:e.prev=14,e.t0=e.catch(3),r=!0,a=e.t0;case 18:e.prev=18,e.prev=19,t||null==n.return||n.return();case 21:if(e.prev=21,r)throw a;e.next=24;break;case 24:return e.finish(21);case 25:return e.finish(18);case 26:case"end":return e.stop()}},e,this,[[3,14,18,26],[19,,21,25]])}),t.values=_regeneratorRuntime.mark(function e(){var t,r,a,n,i,s,c;return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=!(t=!0),a=void 0,e.prev=3,n=this[Symbol.iterator]();case 5:if(t=(i=n.next()).done){e.next=12;break}return s=_slicedToArray(i.value,2),c=s[1],e.next=9,c;case 9:t=!0,e.next=5;break;case 12:e.next=18;break;case 14:e.prev=14,e.t0=e.catch(3),r=!0,a=e.t0;case 18:e.prev=18,e.prev=19,t||null==n.return||n.return();case 21:if(e.prev=21,r)throw a;e.next=24;break;case 24:return e.finish(21);case 25:return e.finish(18);case 26:case"end":return e.stop()}},e,this,[[3,14,18,26],[19,,21,25]])}),t[Symbol.iterator]=_regeneratorRuntime.mark(function e(){var t,r,a,n,i,s,c,h,u,o,l,f,v,p;return _regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=!(t=!0),a=void 0,e.prev=3,n=this.cache[Symbol.iterator]();case 5:if(t=(i=n.next()).done){e.next=12;break}return s=i.value,e.next=9,s;case 9:t=!0,e.next=5;break;case 12:e.next=18;break;case 14:e.prev=14,e.t0=e.catch(3),r=!0,a=e.t0;case 18:e.prev=18,e.prev=19,t||null==n.return||n.return();case 21:if(e.prev=21,r)throw a;e.next=24;break;case 24:return e.finish(21);case 25:return e.finish(18);case 26:h=!(c=!0),u=void 0,e.prev=29,o=this.oldCache[Symbol.iterator]();case 31:if(c=(l=o.next()).done){e.next=40;break}if(f=l.value,v=_slicedToArray(f,1),p=v[0],this.cache.has(p)){e.next=37;break}return e.next=37,f;case 37:c=!0,e.next=31;break;case 40:e.next=46;break;case 42:e.prev=42,e.t1=e.catch(29),h=!0,u=e.t1;case 46:e.prev=46,e.prev=47,c||null==o.return||o.return();case 49:if(e.prev=49,h)throw u;e.next=52;break;case 52:return e.finish(49);case 53:return e.finish(46);case 54:case"end":return e.stop()}},e,this,[[3,14,18,26],[19,,21,25],[29,42,46,54],[47,,49,53]])}),_createClass(e,[{key:"size",get:function(){var e=0,t=!0,r=!1,a=void 0;try{for(var n,i=this.oldCache.keys()[Symbol.iterator]();!(t=(n=i.next()).done);t=!0){var s=n.value;this.cache.has(s)||e++}}catch(e){r=!0,a=e}finally{try{t||null==i.return||i.return()}finally{if(r)throw a}}return this._size+e}}]),e}();module.exports=QuickLRU;
